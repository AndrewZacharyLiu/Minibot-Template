ARM GAS  /var/folders/sg/pxk9dyzj7jz_x3889hx3b3dw0000gn/T//ccQDSnDp.s 			page 1


   1              		.cpu cortex-m4
   2              		.arch armv7e-m
   3              		.fpu fpv4-sp-d16
   4              		.eabi_attribute 27, 1
   5              		.eabi_attribute 28, 1
   6              		.eabi_attribute 20, 1
   7              		.eabi_attribute 21, 1
   8              		.eabi_attribute 23, 3
   9              		.eabi_attribute 24, 1
  10              		.eabi_attribute 25, 1
  11              		.eabi_attribute 26, 1
  12              		.eabi_attribute 30, 1
  13              		.eabi_attribute 34, 1
  14              		.eabi_attribute 18, 4
  15              		.file	"bsp_pwm.c"
  16              		.text
  17              	.Ltext0:
  18              		.cfi_sections	.debug_frame
  19              		.file 1 "control-base/bsp/src/bsp_pwm.c"
  20              		.section	.text.PWM_Start,"ax",%progbits
  21              		.align	1
  22              		.global	PWM_Start
  23              		.syntax unified
  24              		.thumb
  25              		.thumb_func
  27              	PWM_Start:
  28              	.LVL0:
  29              	.LFB135:
   1:control-base/bsp/src/bsp_pwm.c **** #include "bsp_pwm.h"
   2:control-base/bsp/src/bsp_pwm.c **** #include "stdlib.h"
   3:control-base/bsp/src/bsp_pwm.c **** #include "memory.h"
   4:control-base/bsp/src/bsp_pwm.c **** 
   5:control-base/bsp/src/bsp_pwm.c **** #define MAX_PWM_DEVICE_NUM (16)
   6:control-base/bsp/src/bsp_pwm.c **** 
   7:control-base/bsp/src/bsp_pwm.c **** // Interrupt and initialization support
   8:control-base/bsp/src/bsp_pwm.c **** static uint8_t idx;
   9:control-base/bsp/src/bsp_pwm.c **** static PWM_Instance_t *pwm_instance[MAX_PWM_DEVICE_NUM] = {NULL};
  10:control-base/bsp/src/bsp_pwm.c **** 
  11:control-base/bsp/src/bsp_pwm.c **** uint32_t PWM_Get_Tclk(TIM_HandleTypeDef *htim);
  12:control-base/bsp/src/bsp_pwm.c **** 
  13:control-base/bsp/src/bsp_pwm.c **** PWM_Instance_t *PWM_Register(PWM_Config_t *config)
  14:control-base/bsp/src/bsp_pwm.c **** {
  15:control-base/bsp/src/bsp_pwm.c ****     if (idx >= MAX_PWM_DEVICE_NUM)
  16:control-base/bsp/src/bsp_pwm.c ****         while (1)
  17:control-base/bsp/src/bsp_pwm.c ****             ;
  18:control-base/bsp/src/bsp_pwm.c ****     PWM_Instance_t *pwm = (PWM_Instance_t *)malloc(sizeof(PWM_Instance_t));
  19:control-base/bsp/src/bsp_pwm.c **** 
  20:control-base/bsp/src/bsp_pwm.c ****     pwm->htim = config->htim;
  21:control-base/bsp/src/bsp_pwm.c ****     pwm->channel = config->channel;
  22:control-base/bsp/src/bsp_pwm.c ****     pwm->period = config->period;
  23:control-base/bsp/src/bsp_pwm.c ****     pwm->dutyratio = config->dutyratio;
  24:control-base/bsp/src/bsp_pwm.c ****     pwm->id = config->id;
  25:control-base/bsp/src/bsp_pwm.c ****     pwm->tclk = PWM_Get_Tclk(pwm->htim);
  26:control-base/bsp/src/bsp_pwm.c **** 
  27:control-base/bsp/src/bsp_pwm.c ****     // Start PWM
  28:control-base/bsp/src/bsp_pwm.c ****     PWM_Start(pwm);
  29:control-base/bsp/src/bsp_pwm.c ****     PWM_Set_Period(pwm, pwm->period);
ARM GAS  /var/folders/sg/pxk9dyzj7jz_x3889hx3b3dw0000gn/T//ccQDSnDp.s 			page 2


  30:control-base/bsp/src/bsp_pwm.c ****     PWM_Set_Duty_Ratio(pwm, pwm->dutyratio);
  31:control-base/bsp/src/bsp_pwm.c ****     pwm_instance[idx++] = pwm;
  32:control-base/bsp/src/bsp_pwm.c ****     return pwm;
  33:control-base/bsp/src/bsp_pwm.c **** }
  34:control-base/bsp/src/bsp_pwm.c **** 
  35:control-base/bsp/src/bsp_pwm.c **** /* Only provides a formal encapsulation of HAL functions */
  36:control-base/bsp/src/bsp_pwm.c **** void PWM_Start(PWM_Instance_t *pwm)
  37:control-base/bsp/src/bsp_pwm.c **** {
  30              		.loc 1 37 1 view -0
  31              		.cfi_startproc
  32              		@ args = 0, pretend = 0, frame = 0
  33              		@ frame_needed = 0, uses_anonymous_args = 0
  34              		.loc 1 37 1 is_stmt 0 view .LVU1
  35 0000 08B5     		push	{r3, lr}
  36              	.LCFI0:
  37              		.cfi_def_cfa_offset 8
  38              		.cfi_offset 3, -8
  39              		.cfi_offset 14, -4
  38:control-base/bsp/src/bsp_pwm.c ****     HAL_TIM_PWM_Start(pwm->htim, pwm->channel);
  40              		.loc 1 38 5 is_stmt 1 view .LVU2
  41 0002 4168     		ldr	r1, [r0, #4]
  42 0004 0068     		ldr	r0, [r0]
  43              	.LVL1:
  44              		.loc 1 38 5 is_stmt 0 view .LVU3
  45 0006 FFF7FEFF 		bl	HAL_TIM_PWM_Start
  46              	.LVL2:
  39:control-base/bsp/src/bsp_pwm.c **** }
  47              		.loc 1 39 1 view .LVU4
  48 000a 08BD     		pop	{r3, pc}
  49              		.cfi_endproc
  50              	.LFE135:
  52              		.section	.text.PWM_Stop,"ax",%progbits
  53              		.align	1
  54              		.global	PWM_Stop
  55              		.syntax unified
  56              		.thumb
  57              		.thumb_func
  59              	PWM_Stop:
  60              	.LVL3:
  61              	.LFB136:
  40:control-base/bsp/src/bsp_pwm.c **** 
  41:control-base/bsp/src/bsp_pwm.c **** /* Only provides a formal encapsulation of HAL functions */
  42:control-base/bsp/src/bsp_pwm.c **** void PWM_Stop(PWM_Instance_t *pwm)
  43:control-base/bsp/src/bsp_pwm.c **** {
  62              		.loc 1 43 1 is_stmt 1 view -0
  63              		.cfi_startproc
  64              		@ args = 0, pretend = 0, frame = 0
  65              		@ frame_needed = 0, uses_anonymous_args = 0
  66              		.loc 1 43 1 is_stmt 0 view .LVU6
  67 0000 08B5     		push	{r3, lr}
  68              	.LCFI1:
  69              		.cfi_def_cfa_offset 8
  70              		.cfi_offset 3, -8
  71              		.cfi_offset 14, -4
  44:control-base/bsp/src/bsp_pwm.c ****     HAL_TIM_PWM_Stop(pwm->htim, pwm->channel);
  72              		.loc 1 44 5 is_stmt 1 view .LVU7
  73 0002 4168     		ldr	r1, [r0, #4]
ARM GAS  /var/folders/sg/pxk9dyzj7jz_x3889hx3b3dw0000gn/T//ccQDSnDp.s 			page 3


  74 0004 0068     		ldr	r0, [r0]
  75              	.LVL4:
  76              		.loc 1 44 5 is_stmt 0 view .LVU8
  77 0006 FFF7FEFF 		bl	HAL_TIM_PWM_Stop
  78              	.LVL5:
  45:control-base/bsp/src/bsp_pwm.c **** }
  79              		.loc 1 45 1 view .LVU9
  80 000a 08BD     		pop	{r3, pc}
  81              		.cfi_endproc
  82              	.LFE136:
  84              		.section	.text.PWM_Set_Frequency,"ax",%progbits
  85              		.align	1
  86              		.global	PWM_Set_Frequency
  87              		.syntax unified
  88              		.thumb
  89              		.thumb_func
  91              	PWM_Set_Frequency:
  92              	.LVL6:
  93              	.LFB137:
  46:control-base/bsp/src/bsp_pwm.c **** 
  47:control-base/bsp/src/bsp_pwm.c **** /*
  48:control-base/bsp/src/bsp_pwm.c ****  * @brief Set the PWM period
  49:control-base/bsp/src/bsp_pwm.c ****  *
  50:control-base/bsp/src/bsp_pwm.c ****  * @param pwm PWM instance
  51:control-base/bsp/src/bsp_pwm.c ****  * @param freq Frequency in Hz
  52:control-base/bsp/src/bsp_pwm.c ****  */
  53:control-base/bsp/src/bsp_pwm.c **** void PWM_Set_Frequency(PWM_Instance_t *pwm, float freq)
  54:control-base/bsp/src/bsp_pwm.c **** {
  94              		.loc 1 54 1 is_stmt 1 view -0
  95              		.cfi_startproc
  96              		@ args = 0, pretend = 0, frame = 0
  97              		@ frame_needed = 0, uses_anonymous_args = 0
  98              		@ link register save eliminated.
  55:control-base/bsp/src/bsp_pwm.c ****     __HAL_TIM_SetAutoreload(pwm->htim, (pwm->tclk) / (freq * (pwm->htim->Init.Prescaler + 1)));
  99              		.loc 1 55 5 view .LVU11
 100              		.loc 1 55 5 view .LVU12
 101 0000 0268     		ldr	r2, [r0]
 102 0002 5368     		ldr	r3, [r2, #4]
 103 0004 0133     		adds	r3, r3, #1
 104 0006 07EE903A 		vmov	s15, r3	@ int
 105 000a F8EE677A 		vcvt.f32.u32	s15, s15
 106 000e 67EE807A 		vmul.f32	s15, s15, s0
 107 0012 90ED027A 		vldr.32	s14, [r0, #8]	@ int
 108 0016 F8EE476A 		vcvt.f32.u32	s13, s14
 109 001a 86EEA77A 		vdiv.f32	s14, s13, s15
 110 001e 1368     		ldr	r3, [r2]
 111 0020 BCEEC77A 		vcvt.u32.f32	s14, s14
 112 0024 83ED0B7A 		vstr.32	s14, [r3, #44]	@ int
 113              		.loc 1 55 5 view .LVU13
 114 0028 90ED027A 		vldr.32	s14, [r0, #8]	@ int
 115 002c 0268     		ldr	r2, [r0]
 116 002e 5368     		ldr	r3, [r2, #4]
 117 0030 0133     		adds	r3, r3, #1
 118 0032 07EE903A 		vmov	s15, r3	@ int
 119 0036 F8EE677A 		vcvt.f32.u32	s15, s15
 120 003a 27EE800A 		vmul.f32	s0, s15, s0
 121              	.LVL7:
ARM GAS  /var/folders/sg/pxk9dyzj7jz_x3889hx3b3dw0000gn/T//ccQDSnDp.s 			page 4


 122              		.loc 1 55 5 is_stmt 0 view .LVU14
 123 003e B8EE477A 		vcvt.f32.u32	s14, s14
 124 0042 C7EE007A 		vdiv.f32	s15, s14, s0
 125 0046 FCEEE77A 		vcvt.u32.f32	s15, s15
 126 004a C2ED037A 		vstr.32	s15, [r2, #12]	@ int
 127              		.loc 1 55 5 is_stmt 1 view .LVU15
  56:control-base/bsp/src/bsp_pwm.c **** }
 128              		.loc 1 56 1 is_stmt 0 view .LVU16
 129 004e 7047     		bx	lr
 130              		.cfi_endproc
 131              	.LFE137:
 133              		.section	.text.PWM_Set_Period,"ax",%progbits
 134              		.align	1
 135              		.global	PWM_Set_Period
 136              		.syntax unified
 137              		.thumb
 138              		.thumb_func
 140              	PWM_Set_Period:
 141              	.LVL8:
 142              	.LFB138:
  57:control-base/bsp/src/bsp_pwm.c **** 
  58:control-base/bsp/src/bsp_pwm.c **** /*
  59:control-base/bsp/src/bsp_pwm.c ****  * @brief Set the PWM period
  60:control-base/bsp/src/bsp_pwm.c ****  *
  61:control-base/bsp/src/bsp_pwm.c ****  * @param pwm PWM instance
  62:control-base/bsp/src/bsp_pwm.c ****  * @param period Period in seconds
  63:control-base/bsp/src/bsp_pwm.c ****  */
  64:control-base/bsp/src/bsp_pwm.c **** void PWM_Set_Period(PWM_Instance_t *pwm, float period)
  65:control-base/bsp/src/bsp_pwm.c **** {
 143              		.loc 1 65 1 is_stmt 1 view -0
 144              		.cfi_startproc
 145              		@ args = 0, pretend = 0, frame = 0
 146              		@ frame_needed = 0, uses_anonymous_args = 0
 147              		@ link register save eliminated.
  66:control-base/bsp/src/bsp_pwm.c ****     __HAL_TIM_SetAutoreload(pwm->htim, period * ((pwm->tclk) / (pwm->htim->Init.Prescaler + 1)));
 148              		.loc 1 66 5 view .LVU18
 149              		.loc 1 66 5 view .LVU19
 150 0000 8368     		ldr	r3, [r0, #8]
 151 0002 0168     		ldr	r1, [r0]
 152 0004 4A68     		ldr	r2, [r1, #4]
 153 0006 0132     		adds	r2, r2, #1
 154 0008 B3FBF2F3 		udiv	r3, r3, r2
 155 000c 07EE903A 		vmov	s15, r3	@ int
 156 0010 F8EE677A 		vcvt.f32.u32	s15, s15
 157 0014 67EE807A 		vmul.f32	s15, s15, s0
 158 0018 0B68     		ldr	r3, [r1]
 159 001a FCEEE77A 		vcvt.u32.f32	s15, s15
 160 001e C3ED0B7A 		vstr.32	s15, [r3, #44]	@ int
 161              		.loc 1 66 5 view .LVU20
 162 0022 8368     		ldr	r3, [r0, #8]
 163 0024 0168     		ldr	r1, [r0]
 164 0026 4A68     		ldr	r2, [r1, #4]
 165 0028 0132     		adds	r2, r2, #1
 166 002a B3FBF2F3 		udiv	r3, r3, r2
 167 002e 07EE903A 		vmov	s15, r3	@ int
 168 0032 F8EE677A 		vcvt.f32.u32	s15, s15
 169 0036 27EE800A 		vmul.f32	s0, s15, s0
ARM GAS  /var/folders/sg/pxk9dyzj7jz_x3889hx3b3dw0000gn/T//ccQDSnDp.s 			page 5


 170              	.LVL9:
 171              		.loc 1 66 5 is_stmt 0 view .LVU21
 172 003a BCEEC00A 		vcvt.u32.f32	s0, s0
 173 003e 81ED030A 		vstr.32	s0, [r1, #12]	@ int
 174              		.loc 1 66 5 is_stmt 1 view .LVU22
  67:control-base/bsp/src/bsp_pwm.c **** }
 175              		.loc 1 67 1 is_stmt 0 view .LVU23
 176 0042 7047     		bx	lr
 177              		.cfi_endproc
 178              	.LFE138:
 180              		.section	.text.PWM_Set_Duty_Ratio,"ax",%progbits
 181              		.align	1
 182              		.global	PWM_Set_Duty_Ratio
 183              		.syntax unified
 184              		.thumb
 185              		.thumb_func
 187              	PWM_Set_Duty_Ratio:
 188              	.LVL10:
 189              	.LFB139:
  68:control-base/bsp/src/bsp_pwm.c **** 
  69:control-base/bsp/src/bsp_pwm.c **** /*
  70:control-base/bsp/src/bsp_pwm.c ****  * @brief Set the PWM duty ratio
  71:control-base/bsp/src/bsp_pwm.c ****  *
  72:control-base/bsp/src/bsp_pwm.c ****  * @param pwm PWM instance
  73:control-base/bsp/src/bsp_pwm.c ****  * @param dutyratio Duty ratio from 0 to 1
  74:control-base/bsp/src/bsp_pwm.c ****  */
  75:control-base/bsp/src/bsp_pwm.c **** void PWM_Set_Duty_Ratio(PWM_Instance_t *pwm, float dutyratio)
  76:control-base/bsp/src/bsp_pwm.c **** {
 190              		.loc 1 76 1 is_stmt 1 view -0
 191              		.cfi_startproc
 192              		@ args = 0, pretend = 0, frame = 0
 193              		@ frame_needed = 0, uses_anonymous_args = 0
 194              		@ link register save eliminated.
  77:control-base/bsp/src/bsp_pwm.c ****     __HAL_TIM_SetCompare(pwm->htim, pwm->channel, dutyratio * (pwm->htim->Instance->ARR));
 195              		.loc 1 77 5 view .LVU25
 196 0000 4368     		ldr	r3, [r0, #4]
 197 0002 63B9     		cbnz	r3, .L8
 198              		.loc 1 77 5 is_stmt 0 discriminator 1 view .LVU26
 199 0004 0368     		ldr	r3, [r0]
 200 0006 1B68     		ldr	r3, [r3]
 201 0008 D3ED0B7A 		vldr.32	s15, [r3, #44]	@ int
 202 000c F8EE677A 		vcvt.f32.u32	s15, s15
 203 0010 27EE800A 		vmul.f32	s0, s15, s0
 204              	.LVL11:
 205              		.loc 1 77 5 discriminator 1 view .LVU27
 206 0014 BCEEC00A 		vcvt.u32.f32	s0, s0
 207 0018 83ED0D0A 		vstr.32	s0, [r3, #52]	@ int
 208 001c 7047     		bx	lr
 209              	.LVL12:
 210              	.L8:
 211              		.loc 1 77 5 discriminator 2 view .LVU28
 212 001e 042B     		cmp	r3, #4
 213 0020 0ED0     		beq	.L12
 214              		.loc 1 77 5 discriminator 4 view .LVU29
 215 0022 082B     		cmp	r3, #8
 216 0024 19D0     		beq	.L13
 217              		.loc 1 77 5 discriminator 7 view .LVU30
ARM GAS  /var/folders/sg/pxk9dyzj7jz_x3889hx3b3dw0000gn/T//ccQDSnDp.s 			page 6


 218 0026 0368     		ldr	r3, [r0]
 219 0028 1B68     		ldr	r3, [r3]
 220 002a D3ED0B7A 		vldr.32	s15, [r3, #44]	@ int
 221 002e F8EE677A 		vcvt.f32.u32	s15, s15
 222 0032 67EE807A 		vmul.f32	s15, s15, s0
 223 0036 FCEEE77A 		vcvt.u32.f32	s15, s15
 224 003a C3ED107A 		vstr.32	s15, [r3, #64]	@ int
  78:control-base/bsp/src/bsp_pwm.c **** }
 225              		.loc 1 78 1 view .LVU31
 226 003e 7047     		bx	lr
 227              	.L12:
  77:control-base/bsp/src/bsp_pwm.c ****     __HAL_TIM_SetCompare(pwm->htim, pwm->channel, dutyratio * (pwm->htim->Instance->ARR));
 228              		.loc 1 77 5 discriminator 3 view .LVU32
 229 0040 0368     		ldr	r3, [r0]
 230 0042 1B68     		ldr	r3, [r3]
 231 0044 D3ED0B7A 		vldr.32	s15, [r3, #44]	@ int
 232 0048 F8EE677A 		vcvt.f32.u32	s15, s15
 233 004c 67EE807A 		vmul.f32	s15, s15, s0
 234 0050 FCEEE77A 		vcvt.u32.f32	s15, s15
 235 0054 C3ED0E7A 		vstr.32	s15, [r3, #56]	@ int
 236 0058 7047     		bx	lr
 237              	.L13:
  77:control-base/bsp/src/bsp_pwm.c ****     __HAL_TIM_SetCompare(pwm->htim, pwm->channel, dutyratio * (pwm->htim->Instance->ARR));
 238              		.loc 1 77 5 discriminator 6 view .LVU33
 239 005a 0368     		ldr	r3, [r0]
 240 005c 1B68     		ldr	r3, [r3]
 241 005e D3ED0B7A 		vldr.32	s15, [r3, #44]	@ int
 242 0062 F8EE677A 		vcvt.f32.u32	s15, s15
 243 0066 67EE807A 		vmul.f32	s15, s15, s0
 244 006a FCEEE77A 		vcvt.u32.f32	s15, s15
 245 006e C3ED0F7A 		vstr.32	s15, [r3, #60]	@ int
 246 0072 7047     		bx	lr
 247              		.cfi_endproc
 248              	.LFE139:
 250              		.section	.text.PWM_Get_Tclk,"ax",%progbits
 251              		.align	1
 252              		.global	PWM_Get_Tclk
 253              		.syntax unified
 254              		.thumb
 255              		.thumb_func
 257              	PWM_Get_Tclk:
 258              	.LVL13:
 259              	.LFB140:
  79:control-base/bsp/src/bsp_pwm.c **** 
  80:control-base/bsp/src/bsp_pwm.c **** // Set the PWM corresponding timer clock source frequency
  81:control-base/bsp/src/bsp_pwm.c **** // tim2~7,12~14:APB1  tim1,8~11:APB2
  82:control-base/bsp/src/bsp_pwm.c **** uint32_t PWM_Get_Tclk(TIM_HandleTypeDef *htim)
  83:control-base/bsp/src/bsp_pwm.c **** {
 260              		.loc 1 83 1 is_stmt 1 view -0
 261              		.cfi_startproc
 262              		@ args = 0, pretend = 0, frame = 0
 263              		@ frame_needed = 0, uses_anonymous_args = 0
 264              		.loc 1 83 1 is_stmt 0 view .LVU35
 265 0000 08B5     		push	{r3, lr}
 266              	.LCFI2:
 267              		.cfi_def_cfa_offset 8
 268              		.cfi_offset 3, -8
ARM GAS  /var/folders/sg/pxk9dyzj7jz_x3889hx3b3dw0000gn/T//ccQDSnDp.s 			page 7


 269              		.cfi_offset 14, -4
  84:control-base/bsp/src/bsp_pwm.c ****     uintptr_t tclk_temp = ((uintptr_t)((htim)->Instance));
 270              		.loc 1 84 5 is_stmt 1 view .LVU36
 271              		.loc 1 84 46 is_stmt 0 view .LVU37
 272 0002 0368     		ldr	r3, [r0]
 273              	.LVL14:
  85:control-base/bsp/src/bsp_pwm.c ****     if (
 274              		.loc 1 85 5 is_stmt 1 view .LVU38
  86:control-base/bsp/src/bsp_pwm.c ****         (tclk_temp <= (APB1PERIPH_BASE + 0x2000UL)) &&
 275              		.loc 1 86 53 is_stmt 0 view .LVU39
 276 0004 03F14042 		add	r2, r3, #-1073741824
  85:control-base/bsp/src/bsp_pwm.c ****     if (
 277              		.loc 1 85 8 view .LVU40
 278 0008 B2F5005F 		cmp	r2, #8192
 279 000c 0FD9     		bls	.L24
  87:control-base/bsp/src/bsp_pwm.c ****         (tclk_temp >= (APB1PERIPH_BASE + 0x0000UL)))
  88:control-base/bsp/src/bsp_pwm.c ****     {
  89:control-base/bsp/src/bsp_pwm.c ****         return (HAL_RCC_GetPCLK1Freq() * (APBPrescTable[(RCC->CFGR & RCC_CFGR_PPRE1) >> RCC_CFGR_PP
  90:control-base/bsp/src/bsp_pwm.c ****     }
  91:control-base/bsp/src/bsp_pwm.c ****     else if (
 280              		.loc 1 91 10 is_stmt 1 view .LVU41
  92:control-base/bsp/src/bsp_pwm.c ****         ((tclk_temp <= (APB2PERIPH_BASE + 0x0400UL)) &&
 281              		.loc 1 92 54 is_stmt 0 view .LVU42
 282 000e 03F13F42 		add	r2, r3, #-1090519040
 283 0012 02F57F02 		add	r2, r2, #16711680
  91:control-base/bsp/src/bsp_pwm.c ****         ((tclk_temp <= (APB2PERIPH_BASE + 0x0400UL)) &&
 284              		.loc 1 91 13 view .LVU43
 285 0016 B2F5806F 		cmp	r2, #1024
 286 001a 17D9     		bls	.L18
  93:control-base/bsp/src/bsp_pwm.c ****          (tclk_temp >= (APB2PERIPH_BASE + 0x0000UL))) ||
  94:control-base/bsp/src/bsp_pwm.c ****         ((tclk_temp <= (APB2PERIPH_BASE + 0x4800UL)) &&
 287              		.loc 1 94 54 view .LVU44
 288 001c A3F14023 		sub	r3, r3, #1073758208
 289              	.LVL15:
 290              		.loc 1 94 54 view .LVU45
 291 0020 A3F58033 		sub	r3, r3, #65536
  93:control-base/bsp/src/bsp_pwm.c ****          (tclk_temp >= (APB2PERIPH_BASE + 0x0000UL))) ||
 292              		.loc 1 93 55 view .LVU46
 293 0024 B3F5006F 		cmp	r3, #2048
 294 0028 10D9     		bls	.L18
  95:control-base/bsp/src/bsp_pwm.c ****          (tclk_temp >= (APB2PERIPH_BASE + 0x4000UL))))
  96:control-base/bsp/src/bsp_pwm.c ****     {
  97:control-base/bsp/src/bsp_pwm.c ****         return (HAL_RCC_GetPCLK2Freq() * (APBPrescTable[(RCC->CFGR & RCC_CFGR_PPRE1) >> RCC_CFGR_PP
  98:control-base/bsp/src/bsp_pwm.c ****     }
  99:control-base/bsp/src/bsp_pwm.c ****     return 0;
 295              		.loc 1 99 12 view .LVU47
 296 002a 0020     		movs	r0, #0
 297              	.LVL16:
 298              	.L14:
 100:control-base/bsp/src/bsp_pwm.c **** }
 299              		.loc 1 100 1 view .LVU48
 300 002c 08BD     		pop	{r3, pc}
 301              	.LVL17:
 302              	.L24:
  89:control-base/bsp/src/bsp_pwm.c ****     }
 303              		.loc 1 89 9 is_stmt 1 view .LVU49
  89:control-base/bsp/src/bsp_pwm.c ****     }
ARM GAS  /var/folders/sg/pxk9dyzj7jz_x3889hx3b3dw0000gn/T//ccQDSnDp.s 			page 8


 304              		.loc 1 89 17 is_stmt 0 view .LVU50
 305 002e FFF7FEFF 		bl	HAL_RCC_GetPCLK1Freq
 306              	.LVL18:
  89:control-base/bsp/src/bsp_pwm.c ****     }
 307              		.loc 1 89 61 discriminator 1 view .LVU51
 308 0032 0E4B     		ldr	r3, .L25
 309 0034 9B68     		ldr	r3, [r3, #8]
  89:control-base/bsp/src/bsp_pwm.c ****     }
 310              		.loc 1 89 86 discriminator 1 view .LVU52
 311 0036 C3F38223 		ubfx	r3, r3, #10, #3
  89:control-base/bsp/src/bsp_pwm.c ****     }
 312              		.loc 1 89 56 discriminator 1 view .LVU53
 313 003a 0D4A     		ldr	r2, .L25+4
 314 003c D35C     		ldrb	r3, [r2, r3]	@ zero_extendqisi2
  89:control-base/bsp/src/bsp_pwm.c ****     }
 315              		.loc 1 89 118 discriminator 1 view .LVU54
 316 003e 1BB9     		cbnz	r3, .L20
 317 0040 0123     		movs	r3, #1
 318              	.L16:
  89:control-base/bsp/src/bsp_pwm.c ****     }
 319              		.loc 1 89 40 discriminator 4 view .LVU55
 320 0042 03FB00F0 		mul	r0, r3, r0
  89:control-base/bsp/src/bsp_pwm.c ****     }
 321              		.loc 1 89 40 view .LVU56
 322 0046 F1E7     		b	.L14
 323              	.L20:
  89:control-base/bsp/src/bsp_pwm.c ****     }
 324              		.loc 1 89 118 discriminator 2 view .LVU57
 325 0048 0223     		movs	r3, #2
 326 004a FAE7     		b	.L16
 327              	.LVL19:
 328              	.L18:
  97:control-base/bsp/src/bsp_pwm.c ****     }
 329              		.loc 1 97 9 is_stmt 1 view .LVU58
  97:control-base/bsp/src/bsp_pwm.c ****     }
 330              		.loc 1 97 17 is_stmt 0 view .LVU59
 331 004c FFF7FEFF 		bl	HAL_RCC_GetPCLK2Freq
 332              	.LVL20:
  97:control-base/bsp/src/bsp_pwm.c ****     }
 333              		.loc 1 97 61 discriminator 1 view .LVU60
 334 0050 064B     		ldr	r3, .L25
 335 0052 9B68     		ldr	r3, [r3, #8]
  97:control-base/bsp/src/bsp_pwm.c ****     }
 336              		.loc 1 97 86 discriminator 1 view .LVU61
 337 0054 C3F38223 		ubfx	r3, r3, #10, #3
  97:control-base/bsp/src/bsp_pwm.c ****     }
 338              		.loc 1 97 56 discriminator 1 view .LVU62
 339 0058 054A     		ldr	r2, .L25+4
 340 005a D35C     		ldrb	r3, [r2, r3]	@ zero_extendqisi2
  97:control-base/bsp/src/bsp_pwm.c ****     }
 341              		.loc 1 97 118 discriminator 1 view .LVU63
 342 005c 1BB9     		cbnz	r3, .L22
 343 005e 0123     		movs	r3, #1
 344              	.L19:
  97:control-base/bsp/src/bsp_pwm.c ****     }
 345              		.loc 1 97 40 discriminator 4 view .LVU64
 346 0060 03FB00F0 		mul	r0, r3, r0
ARM GAS  /var/folders/sg/pxk9dyzj7jz_x3889hx3b3dw0000gn/T//ccQDSnDp.s 			page 9


  97:control-base/bsp/src/bsp_pwm.c ****     }
 347              		.loc 1 97 40 view .LVU65
 348 0064 E2E7     		b	.L14
 349              	.L22:
  97:control-base/bsp/src/bsp_pwm.c ****     }
 350              		.loc 1 97 118 discriminator 2 view .LVU66
 351 0066 0223     		movs	r3, #2
 352 0068 FAE7     		b	.L19
 353              	.L26:
 354 006a 00BF     		.align	2
 355              	.L25:
 356 006c 00380240 		.word	1073887232
 357 0070 00000000 		.word	APBPrescTable
 358              		.cfi_endproc
 359              	.LFE140:
 361              		.section	.text.PWM_Register,"ax",%progbits
 362              		.align	1
 363              		.global	PWM_Register
 364              		.syntax unified
 365              		.thumb
 366              		.thumb_func
 368              	PWM_Register:
 369              	.LVL21:
 370              	.LFB134:
  14:control-base/bsp/src/bsp_pwm.c ****     if (idx >= MAX_PWM_DEVICE_NUM)
 371              		.loc 1 14 1 is_stmt 1 view -0
 372              		.cfi_startproc
 373              		@ args = 0, pretend = 0, frame = 0
 374              		@ frame_needed = 0, uses_anonymous_args = 0
  14:control-base/bsp/src/bsp_pwm.c ****     if (idx >= MAX_PWM_DEVICE_NUM)
 375              		.loc 1 14 1 is_stmt 0 view .LVU68
 376 0000 38B5     		push	{r3, r4, r5, lr}
 377              	.LCFI3:
 378              		.cfi_def_cfa_offset 16
 379              		.cfi_offset 3, -16
 380              		.cfi_offset 4, -12
 381              		.cfi_offset 5, -8
 382              		.cfi_offset 14, -4
  15:control-base/bsp/src/bsp_pwm.c ****         while (1)
 383              		.loc 1 15 5 is_stmt 1 view .LVU69
  15:control-base/bsp/src/bsp_pwm.c ****         while (1)
 384              		.loc 1 15 13 is_stmt 0 view .LVU70
 385 0002 164B     		ldr	r3, .L31
 386 0004 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
  15:control-base/bsp/src/bsp_pwm.c ****         while (1)
 387              		.loc 1 15 8 view .LVU71
 388 0006 0F2B     		cmp	r3, #15
 389 0008 00D9     		bls	.L28
 390              	.L29:
  16:control-base/bsp/src/bsp_pwm.c ****             ;
 391              		.loc 1 16 9 is_stmt 1 view .LVU72
  16:control-base/bsp/src/bsp_pwm.c ****             ;
 392              		.loc 1 16 15 view .LVU73
 393 000a FEE7     		b	.L29
 394              	.L28:
 395 000c 0546     		mov	r5, r0
  18:control-base/bsp/src/bsp_pwm.c **** 
ARM GAS  /var/folders/sg/pxk9dyzj7jz_x3889hx3b3dw0000gn/T//ccQDSnDp.s 			page 10


 396              		.loc 1 18 5 view .LVU74
  18:control-base/bsp/src/bsp_pwm.c **** 
 397              		.loc 1 18 45 is_stmt 0 view .LVU75
 398 000e 1820     		movs	r0, #24
 399              	.LVL22:
  18:control-base/bsp/src/bsp_pwm.c **** 
 400              		.loc 1 18 45 view .LVU76
 401 0010 FFF7FEFF 		bl	malloc
 402              	.LVL23:
 403 0014 0446     		mov	r4, r0
 404              	.LVL24:
  20:control-base/bsp/src/bsp_pwm.c ****     pwm->channel = config->channel;
 405              		.loc 1 20 5 is_stmt 1 view .LVU77
  20:control-base/bsp/src/bsp_pwm.c ****     pwm->channel = config->channel;
 406              		.loc 1 20 23 is_stmt 0 view .LVU78
 407 0016 2868     		ldr	r0, [r5]
 408              	.LVL25:
  20:control-base/bsp/src/bsp_pwm.c ****     pwm->channel = config->channel;
 409              		.loc 1 20 15 view .LVU79
 410 0018 2060     		str	r0, [r4]
  21:control-base/bsp/src/bsp_pwm.c ****     pwm->period = config->period;
 411              		.loc 1 21 5 is_stmt 1 view .LVU80
  21:control-base/bsp/src/bsp_pwm.c ****     pwm->period = config->period;
 412              		.loc 1 21 26 is_stmt 0 view .LVU81
 413 001a 6B68     		ldr	r3, [r5, #4]
  21:control-base/bsp/src/bsp_pwm.c ****     pwm->period = config->period;
 414              		.loc 1 21 18 view .LVU82
 415 001c 6360     		str	r3, [r4, #4]
  22:control-base/bsp/src/bsp_pwm.c ****     pwm->dutyratio = config->dutyratio;
 416              		.loc 1 22 5 is_stmt 1 view .LVU83
  22:control-base/bsp/src/bsp_pwm.c ****     pwm->dutyratio = config->dutyratio;
 417              		.loc 1 22 25 is_stmt 0 view .LVU84
 418 001e AB68     		ldr	r3, [r5, #8]	@ float
  22:control-base/bsp/src/bsp_pwm.c ****     pwm->dutyratio = config->dutyratio;
 419              		.loc 1 22 17 view .LVU85
 420 0020 E360     		str	r3, [r4, #12]	@ float
  23:control-base/bsp/src/bsp_pwm.c ****     pwm->id = config->id;
 421              		.loc 1 23 5 is_stmt 1 view .LVU86
  23:control-base/bsp/src/bsp_pwm.c ****     pwm->id = config->id;
 422              		.loc 1 23 28 is_stmt 0 view .LVU87
 423 0022 EB68     		ldr	r3, [r5, #12]	@ float
  23:control-base/bsp/src/bsp_pwm.c ****     pwm->id = config->id;
 424              		.loc 1 23 20 view .LVU88
 425 0024 2361     		str	r3, [r4, #16]	@ float
  24:control-base/bsp/src/bsp_pwm.c ****     pwm->tclk = PWM_Get_Tclk(pwm->htim);
 426              		.loc 1 24 5 is_stmt 1 view .LVU89
  24:control-base/bsp/src/bsp_pwm.c ****     pwm->tclk = PWM_Get_Tclk(pwm->htim);
 427              		.loc 1 24 21 is_stmt 0 view .LVU90
 428 0026 2B7C     		ldrb	r3, [r5, #16]	@ zero_extendqisi2
  24:control-base/bsp/src/bsp_pwm.c ****     pwm->tclk = PWM_Get_Tclk(pwm->htim);
 429              		.loc 1 24 13 view .LVU91
 430 0028 2375     		strb	r3, [r4, #20]
  25:control-base/bsp/src/bsp_pwm.c **** 
 431              		.loc 1 25 5 is_stmt 1 view .LVU92
  25:control-base/bsp/src/bsp_pwm.c **** 
 432              		.loc 1 25 17 is_stmt 0 view .LVU93
 433 002a FFF7FEFF 		bl	PWM_Get_Tclk
ARM GAS  /var/folders/sg/pxk9dyzj7jz_x3889hx3b3dw0000gn/T//ccQDSnDp.s 			page 11


 434              	.LVL26:
  25:control-base/bsp/src/bsp_pwm.c **** 
 435              		.loc 1 25 15 discriminator 1 view .LVU94
 436 002e A060     		str	r0, [r4, #8]
  28:control-base/bsp/src/bsp_pwm.c ****     PWM_Set_Period(pwm, pwm->period);
 437              		.loc 1 28 5 is_stmt 1 view .LVU95
 438 0030 2046     		mov	r0, r4
 439 0032 FFF7FEFF 		bl	PWM_Start
 440              	.LVL27:
  29:control-base/bsp/src/bsp_pwm.c ****     PWM_Set_Duty_Ratio(pwm, pwm->dutyratio);
 441              		.loc 1 29 5 view .LVU96
 442 0036 94ED030A 		vldr.32	s0, [r4, #12]
 443 003a 2046     		mov	r0, r4
 444 003c FFF7FEFF 		bl	PWM_Set_Period
 445              	.LVL28:
  30:control-base/bsp/src/bsp_pwm.c ****     pwm_instance[idx++] = pwm;
 446              		.loc 1 30 5 view .LVU97
 447 0040 94ED040A 		vldr.32	s0, [r4, #16]
 448 0044 2046     		mov	r0, r4
 449 0046 FFF7FEFF 		bl	PWM_Set_Duty_Ratio
 450              	.LVL29:
  31:control-base/bsp/src/bsp_pwm.c ****     return pwm;
 451              		.loc 1 31 5 view .LVU98
  31:control-base/bsp/src/bsp_pwm.c ****     return pwm;
 452              		.loc 1 31 21 is_stmt 0 view .LVU99
 453 004a 044A     		ldr	r2, .L31
 454 004c 1378     		ldrb	r3, [r2]	@ zero_extendqisi2
 455 004e 591C     		adds	r1, r3, #1
 456 0050 1170     		strb	r1, [r2]
  31:control-base/bsp/src/bsp_pwm.c ****     return pwm;
 457              		.loc 1 31 25 view .LVU100
 458 0052 034A     		ldr	r2, .L31+4
 459 0054 42F82340 		str	r4, [r2, r3, lsl #2]
  32:control-base/bsp/src/bsp_pwm.c **** }
 460              		.loc 1 32 5 is_stmt 1 view .LVU101
  33:control-base/bsp/src/bsp_pwm.c **** 
 461              		.loc 1 33 1 is_stmt 0 view .LVU102
 462 0058 2046     		mov	r0, r4
 463 005a 38BD     		pop	{r3, r4, r5, pc}
 464              	.LVL30:
 465              	.L32:
  33:control-base/bsp/src/bsp_pwm.c **** 
 466              		.loc 1 33 1 view .LVU103
 467              		.align	2
 468              	.L31:
 469 005c 00000000 		.word	idx
 470 0060 00000000 		.word	pwm_instance
 471              		.cfi_endproc
 472              	.LFE134:
 474              		.section	.bss.pwm_instance,"aw",%nobits
 475              		.align	2
 478              	pwm_instance:
 479 0000 00000000 		.space	64
 479      00000000 
 479      00000000 
 479      00000000 
 479      00000000 
ARM GAS  /var/folders/sg/pxk9dyzj7jz_x3889hx3b3dw0000gn/T//ccQDSnDp.s 			page 12


 480              		.section	.bss.idx,"aw",%nobits
 483              	idx:
 484 0000 00       		.space	1
 485              		.text
 486              	.Letext0:
 487              		.file 2 "/Applications/ArmGNUToolchain/14.3.rel1/arm-none-eabi/arm-none-eabi/include/machine/_defa
 488              		.file 3 "/Applications/ArmGNUToolchain/14.3.rel1/arm-none-eabi/arm-none-eabi/include/sys/_stdint.h
 489              		.file 4 "control-base/typec-board-base/Drivers/CMSIS/Device/ST/STM32F4xx/Include/stm32f407xx.h"
 490              		.file 5 "control-base/typec-board-base/Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_def.h"
 491              		.file 6 "control-base/typec-board-base/Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_dma.h"
 492              		.file 7 "control-base/typec-board-base/Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_tim.h"
 493              		.file 8 "control-base/bsp/inc/bsp_pwm.h"
 494              		.file 9 "control-base/typec-board-base/Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_rcc.h"
 495              		.file 10 "/Applications/ArmGNUToolchain/14.3.rel1/arm-none-eabi/arm-none-eabi/include/stdlib.h"
 496              		.file 11 "control-base/typec-board-base/Drivers/CMSIS/Device/ST/STM32F4xx/Include/system_stm32f4xx
ARM GAS  /var/folders/sg/pxk9dyzj7jz_x3889hx3b3dw0000gn/T//ccQDSnDp.s 			page 13


DEFINED SYMBOLS
                            *ABS*:00000000 bsp_pwm.c
/var/folders/sg/pxk9dyzj7jz_x3889hx3b3dw0000gn/T//ccQDSnDp.s:21     .text.PWM_Start:00000000 $t
/var/folders/sg/pxk9dyzj7jz_x3889hx3b3dw0000gn/T//ccQDSnDp.s:27     .text.PWM_Start:00000000 PWM_Start
/var/folders/sg/pxk9dyzj7jz_x3889hx3b3dw0000gn/T//ccQDSnDp.s:53     .text.PWM_Stop:00000000 $t
/var/folders/sg/pxk9dyzj7jz_x3889hx3b3dw0000gn/T//ccQDSnDp.s:59     .text.PWM_Stop:00000000 PWM_Stop
/var/folders/sg/pxk9dyzj7jz_x3889hx3b3dw0000gn/T//ccQDSnDp.s:85     .text.PWM_Set_Frequency:00000000 $t
/var/folders/sg/pxk9dyzj7jz_x3889hx3b3dw0000gn/T//ccQDSnDp.s:91     .text.PWM_Set_Frequency:00000000 PWM_Set_Frequency
/var/folders/sg/pxk9dyzj7jz_x3889hx3b3dw0000gn/T//ccQDSnDp.s:134    .text.PWM_Set_Period:00000000 $t
/var/folders/sg/pxk9dyzj7jz_x3889hx3b3dw0000gn/T//ccQDSnDp.s:140    .text.PWM_Set_Period:00000000 PWM_Set_Period
/var/folders/sg/pxk9dyzj7jz_x3889hx3b3dw0000gn/T//ccQDSnDp.s:181    .text.PWM_Set_Duty_Ratio:00000000 $t
/var/folders/sg/pxk9dyzj7jz_x3889hx3b3dw0000gn/T//ccQDSnDp.s:187    .text.PWM_Set_Duty_Ratio:00000000 PWM_Set_Duty_Ratio
/var/folders/sg/pxk9dyzj7jz_x3889hx3b3dw0000gn/T//ccQDSnDp.s:251    .text.PWM_Get_Tclk:00000000 $t
/var/folders/sg/pxk9dyzj7jz_x3889hx3b3dw0000gn/T//ccQDSnDp.s:257    .text.PWM_Get_Tclk:00000000 PWM_Get_Tclk
/var/folders/sg/pxk9dyzj7jz_x3889hx3b3dw0000gn/T//ccQDSnDp.s:356    .text.PWM_Get_Tclk:0000006c $d
/var/folders/sg/pxk9dyzj7jz_x3889hx3b3dw0000gn/T//ccQDSnDp.s:362    .text.PWM_Register:00000000 $t
/var/folders/sg/pxk9dyzj7jz_x3889hx3b3dw0000gn/T//ccQDSnDp.s:368    .text.PWM_Register:00000000 PWM_Register
/var/folders/sg/pxk9dyzj7jz_x3889hx3b3dw0000gn/T//ccQDSnDp.s:469    .text.PWM_Register:0000005c $d
/var/folders/sg/pxk9dyzj7jz_x3889hx3b3dw0000gn/T//ccQDSnDp.s:483    .bss.idx:00000000 idx
/var/folders/sg/pxk9dyzj7jz_x3889hx3b3dw0000gn/T//ccQDSnDp.s:478    .bss.pwm_instance:00000000 pwm_instance
/var/folders/sg/pxk9dyzj7jz_x3889hx3b3dw0000gn/T//ccQDSnDp.s:475    .bss.pwm_instance:00000000 $d
/var/folders/sg/pxk9dyzj7jz_x3889hx3b3dw0000gn/T//ccQDSnDp.s:484    .bss.idx:00000000 $d

UNDEFINED SYMBOLS
HAL_TIM_PWM_Start
HAL_TIM_PWM_Stop
HAL_RCC_GetPCLK1Freq
HAL_RCC_GetPCLK2Freq
APBPrescTable
malloc
